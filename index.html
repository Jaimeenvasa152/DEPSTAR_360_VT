<head>
    <!-- for optimal display on high DPI devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@photo-sphere-viewer/core@5/index.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@photo-sphere-viewer/markers-plugin@5/index.css" />
    <link rel="stylesheet" href="style.css" />
</head>

<!-- the viewer container must have a defined size -->
<div id="viewer" style="width: 100vw; height: 100vh;"></div>

<custom-marker id="custom-marker-element" style="display: none">
    <!-- Custom marker content -->
    <img src="/DEPSTAR/img/1.jpg" />
    <h2>Custom Marker</h2>
    <p>This is a custom marker for the virtual tour.</p>
</custom-marker>

<custom-marker id="custom-marker-element" style="display: none">
    <!-- Custom marker content -->
    <img src="/img/1.jpg" />
    <h2>Custom Marker</h2>
    <p>This is a custom marker for the virtual tour.</p>
</custom-marker>

<head>
    <!-- for optimal display on high DPI devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@photo-sphere-viewer/core@5/index.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@photo-sphere-viewer/markers-plugin@5/index.css" />
    <link rel="stylesheet" href="style.css" />
</head>

<!-- the viewer container must have a defined size -->
<div id="viewer" style="width: 100vw; height: 100vh;"></div>

<script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.165.0/build/three.module.js",
            "@photo-sphere-viewer/core": "https://cdn.jsdelivr.net/npm/@photo-sphere-viewer/core/index.module.js",
            "@photo-sphere-viewer/virtual-tour-plugin": "https://cdn.jsdelivr.net/npm/@photo-sphere-viewer/virtual-tour-plugin@5/index.module.js",
            "@photo-sphere-viewer/gallery-plugin": "https://cdn.jsdelivr.net/npm/@photo-sphere-viewer/gallery-plugin@5/index.module.js",
            "@photo-sphere-viewer/markers-plugin": "https://cdn.jsdelivr.net/npm/@photo-sphere-viewer/markers-plugin@5/index.module.js"
        }
    }
</script>

<script type="module">
    
    import { Viewer } from '@photo-sphere-viewer/core';
    import { VirtualTourPlugin } from '@photo-sphere-viewer/virtual-tour-plugin';
    import { MarkersPlugin } from '@photo-sphere-viewer/markers-plugin';

    const baseUrl = 'https://photo-sphere-viewer-data.netlify.app/assets/';
    const caption = 'Cape Florida Light, Key Biscayne <b>&copy; Pixexid</b>';

    const markerLighthouse = {
        id: 'marker-1',
        image: baseUrl + 'pictos/pin-red.png',
        tooltip: 'Cape Florida Light, Key Biscayne',
        size: { width: 32, height: 32 },
        anchor: 'bottom center',
        gps: [-80.155973, 25.666601, 29 + 3],
    };

    // Declare the custom marker element
    class CustomMarkerElement extends HTMLElement {
        constructor() {
            super();
            this.fmt = new Intl.NumberFormat({ maximumSignificantDigits: 4 });
            const dom = this.attachShadow({ mode: 'closed' });

            const style = document.createElement('style');
            style.innerText = `
:host {
    display: block;
    position: relative;
    width: 50px;
    height: 50px;
}
button {
    width: 100%;
    height: 100%;
    padding: 0;
    border: none;
    background: none;
    color: white;
    border-radius: 50%;
    filter: drop-shadow(0 10px 5px rgba(0, 0, 0, 0.2));
}
.tooltip {
    box-sizing: border-box;
    width: 300px;
    position: absolute;
    bottom: calc(100% + 10px);
    left: calc(50% -  150px);
    background: rgba(30, 30, 30, 0.8);
    color: white;
    text-shadow: 0 1px #000;
    border-radius: 10px;
    transform-origin: 50% calc(100% + 35px);
    transform: rotate(30deg);
    opacity: 0;
}
.tooltip.bottom {
    bottom: auto;
    top: calc(100% + 10px);
    transform-origin: 50% -35px;
}
.tooltip.hovered {
    animation: rotate-bounce-out 200ms ease forwards;
}
.tooltip slot::slotted(img) {
    width: 100%;
    border-radius: 10px 10px 0 0;
}
.tooltip slot::slotted(h2),
.tooltip slot::slotted(p) {
    margin: 1rem;
    text-align: justify;
}
.tooltip pre {
    font-size: 0.8em;
    margin: 1rem;
}
.tooltip::after {
    content: '';
    width: 0px;
    height: 0px;
    color: rgba(30, 30, 30, 0.8);
    border: 10px solid transparent;
    border-top-color: currentColor;
    position: absolute;
    top: 100%;
    left: 50%;
    margin-left: -10px;
}
.tooltip.bottom::after {
    border-top-color: transparent;
    border-bottom-color: currentColor;
    top: auto;
    bottom: 100%;
}
button:hover {
    animation: ripple 1s ease-out;
}
.tooltip.hiding {
    animation: hide 200ms ease forwards;
}
button:hover + .tooltip {
    animation: show 300ms ease forwards;
}
@keyframes ripple {
    0% { box-shadow: 0 0 0 0 rgba(97, 170, 242, 0); }
    20% { box-shadow: 0 0 0 5px rgba(97, 170, 242, 1); }
    100% { box-shadow: 0 0 0 20px rgba(97, 170, 242, 0); }
}
@keyframes show {
    0% { transform: rotate(30deg); opacity: 0; }
    70% { transform: rotate(-10deg); }
    100% { transform: rotate(0deg); opacity: 1; }
}
@keyframes hide {
    0% { transform: rotate(0deg); opacity: 1; }
    100% { transform: rotate(30deg); opacity: 0; }
}
`;
            dom.appendChild(style);

            const button = document.createElement('button');
            button.innerHTML = `<svg viewBox="0 0 100 100">
<circle cx=50 cy=50 r=25 fill="currentColor"/>
<circle cx=50 cy=50 r=40 stroke-width=10 fill="none" stroke="currentColor"/>
</svg>`;
            dom.appendChild(button);

            this.tooltip = document.createElement('div');
            this.tooltip.classList.add('tooltip');
            dom.appendChild(this.tooltip);
            this.tooltip.innerHTML = '<slot></slot>';

            this.legend = document.createElement('pre');
            this.tooltip.appendChild(this.legend);

            button.addEventListener('mouseleave', () => {
                this.tooltip.classList.add('hiding');
            });

            dom.addEventListener('animationend', () => {
                this.tooltip.classList.remove('hiding');
            });
        }

        updateMarker({ marker, position, viewerPosition, zoomLevel, viewerSize }) {
            this.legend.innerText = `Params
position: ${position.x}px x ${position.y}px
viewerPosition: ${this.fmt.format(viewerPosition.yaw)}rad / ${this.fmt.format(viewerPosition.pitch)}rad
zoomLevel: ${zoomLevel}%
viewerSize: ${viewerSize.width}px x ${viewerSize.height}px
`;
            this.tooltip.classList.toggle('bottom', position.y < viewerSize.height / 3);
        }
    }

    // Register the custom element
    customElements.define('custom-marker', CustomMarkerElement);

    const viewer = new Viewer({
        container: document.querySelector('#viewer'),
        panorama: '/DEPSTAR/img/1.jpg',
        loadingImg: baseUrl + 'loading.svg',
        touchmoveTwoFingers: true,
        defaultYaw: '1deg',
        plugins: [
            [VirtualTourPlugin, {
                positionMode: 'gps',
                renderMode: '3d',
                transitionOptions: {
                    fadeIn: true, // Disable fade-in for smoother transition
                    rotation: true, // Enable rotation during transition
                    showLoader: false,
                    speed: "10rpm", // Adjust the speed of transition
                    zoomTo: 10, // Set your desired zoom level here
                }
            }], 
            MarkersPlugin, 
        ],
    });
    
    const virtualTour = viewer.getPlugin(VirtualTourPlugin);

    virtualTour.setNodes([
                        {
                            id: 'GF1',
                            panorama: '/img/1.jpg',
                            name: 'GROUND_FLOOR',
                            links: [{ nodeId: 'GF2'}],
                            gps: [1458.487697, 50.347589, 1],
                            panoData: { poseHeading: 318 },
                            sphereCorrection: { pan: '-30deg' },
                        },
                        {
                            id: 'GF2',
                            panorama: '/img/2.jpg',
                            name: 'GROUND_FLOOR',
                            links: [{ nodeId: 'GF3' }],
                            gps: [1458.487697, 50.347589, 1],
                            panoData: { poseHeading: 318 },
                            sphereCorrection: { pan: '-30deg' },
                        },
                        {
                            id: 'GF3',
                            panorama: '/DEPSTAR/img/3.jpg',
                            name: 'GROUND_FLOOR',
                            links: [{ nodeId: 'GF4' }],
                            gps: [1458.487697, 50.347589, 1],
                            panoData: { poseHeading: 318 },
                            sphereCorrection: { pan: '-30deg' },
                        },
                        {
                            id: 'GF4',
                            panorama: '/DEPSTAR/img/4.jpg',
                            name: 'GROUND_FLOOR',
                            links: [{ nodeId: 'GF5' }],
                            gps: [1458.487697, 50.347589, 1],
                            panoData: { poseHeading: 318 },
                            sphereCorrection: { pan: '-30deg' },
                        },
                        {
                            id: 'GF5',
                            panorama: '/DEPSTAR/img/5.jpg',
                            name: 'GROUND_FLOOR',
                            links: [{ nodeId: 'GF6' }],
                            gps: [1458.487697, 50.347589, 1],
                            panoData: { poseHeading: 318 },
                            sphereCorrection: { pan: '-30deg' },
                        },
                        {
                            id: 'GF6',
                            panorama: '/DEPSTAR/img/6.jpg',
                            name: 'GROUND_FLOOR',
                            links: [{ nodeId: 'GF7' }],
                            gps: [1458.487697, 50.347589, 1],
                            panoData: { poseHeading: 318 },
                            sphereCorrection: { pan: '-30deg' },
                        },
                        {
                            id: 'GF7',
                            panorama: '/DEPSTAR/img/7.jpg',
                            name: 'GROUND_FLOOR',
                            links: [{ nodeId: 'GF8' }],
                            gps: [1458.487697, 50.347589, 1],
                            panoData: { poseHeading: 318 },
                            sphereCorrection: { pan: '-30deg' },
                        },
                        {
                            id: 'GF8',
                            panorama: '/DEPSTAR/img/8.jpg',
                            name: 'GROUND_FLOOR',
                            links: [{ nodeId: 'GF9' }],
                            gps: [1458.487697, 50.347589, 1],
                            panoData: { poseHeading: 318 },
                            sphereCorrection: { pan: '-30deg' },
                        },
                        {
                            id: 'GF9',
                            panorama: '/DEPSTAR/img/9.jpg',
                            name: 'GROUND_FLOOR',
                            links: [{ nodeId: 'GF10' }],
                            gps: [1458.487697, 50.347589, 1],
                            panoData: { poseHeading: 318 },
                            sphereCorrection: { pan: '-30deg' },
                        },
                        {
                            id: 'GF10',
                            panorama: '/DEPSTAR/img/10.jpg',
                            name: 'GROUND_FLOOR',
                            links: [{ nodeId: 'GF11' }],
                            gps: [1458.487697, 50.347589, 1],
                            panoData: { poseHeading: 318 },
                            sphereCorrection: { pan: '-30deg' },
                        },
                        {
                            id: 'GF11',
                            panorama: '/DEPSTAR/img/11.jpg',
                            name: 'GROUND_FLOOR',
                            links: [{ nodeId: 'GF12' }],
                            gps: [1458.487697, 50.347589, 1],
                            panoData: { poseHeading: 318 },
                            sphereCorrection: { pan: '-30deg' },
                        },
                        {
                            id: 'GF12',
                            panorama: '/DEPSTAR/img/12.jpg',
                            name: 'GROUND_FLOOR',
                            links: [{ nodeId: 'GF13' }],
                            gps: [1458.487697, 50.347589, 1],
                            panoData: { poseHeading: 318 },
                            sphereCorrection: { pan: '-30deg' },
                        },

                        {
                            id: 'GF13',
                            panorama: '/DEPSTAR/img/13.jpg',
                            name: 'GROUND_FLOOR',
                            links: [{ nodeId: 'GF14' }],
                            gps: [1458.487697, 50.347589, 1],
                            panoData: { poseHeading: 318 },
                            sphereCorrection: { pan: '-30deg' },
                        },
                        {
                            id: 'GF14',
                            panorama: '/DEPSTAR/img/14.jpg',
                            name: 'GROUND_FLOOR',
                            links: [{ nodeId: 'GF15' }],
                            gps: [1458.487697, 50.347589, 1],
                            panoData: { poseHeading: 318 },
                            sphereCorrection: { pan: '-30deg' },
                        },

                        {
                            id: 'GF15',
                            panorama: '/DEPSTAR/img/15.jpg',
                            name: 'GROUND_FLOOR',
                            links: [{ nodeId: 'GF16' }],
                            gps: [1458.487697, 50.347589, 1],
                            panoData: { poseHeading: 318 },
                            sphereCorrection: { pan: '-30deg' },
                        },

                        {
                            id: 'GF16',
                            panorama: '/DEPSTAR/img/16.jpg',
                            name: 'GROUND_FLOOR',
                            links: [{ nodeId: 'GF17' }],
                            gps: [1458.487697, 50.347589, 1],
                            panoData: { poseHeading: 318 },
                            sphereCorrection: { pan: '-30deg' },
                        },

                        {
                            id: 'GF17',
                            panorama: '/DEPSTAR/img/17.jpg',
                            name: 'GROUND_FLOOR',
                            links: [{ nodeId: 'GF18' }],
                            gps: [1458.487697, 50.347589, 1],
                            panoData: { poseHeading: 318 },
                            sphereCorrection: { pan: '-30deg' },
                        },
                        {
                            id: 'GF18',
                            panorama: '/DEPSTAR/img/18.jpg',
                            name: 'GROUND_FLOOR',
                            links: [{ nodeId: 'GF19' }],
                            gps: [1458.487697, 50.347589, 1],
                            panoData: { poseHeading: 318 },
                            sphereCorrection: { pan: '-30deg' },
                        },
                        {
                            id: 'GF19',
                            panorama: '/DEPSTAR/img/19.jpg',
                            name: 'GROUND_FLOOR',
                            links: [{ nodeId: 'GF20' }],
                            gps: [1458.487697, 50.347589, 1],
                            panoData: { poseHeading: 318 },
                            sphereCorrection: { pan: '-30deg' },
                        },

                        {
                            id: 'GF20',
                            panorama: '/DEPSTAR/img/20.jpg',
                            name: 'GROUND_FLOOR',
                            links: [{ nodeId: 'GF21' }],
                            gps: [1458.487697, 50.347589, 1],
                            panoData: { poseHeading: 318 },
                            sphereCorrection: { pan: '-30deg' },
                        },

                        {
                            id: 'GF21',
                            panorama: '/DEPSTAR/img/21.jpg',
                            name: 'GROUND_FLOOR',
                            links: [{ nodeId: 'GF22' }],
                            gps: [1458.487697, 50.347589, 1],
                            panoData: { poseHeading: 318 },
                            sphereCorrection: { pan: '-30deg' },
                        },

                        {
                            id: 'GF22',
                            panorama: '/DEPSTAR/img/22.jpg',
                            name: 'GROUND_FLOOR',
                            links: [{ nodeId: 'GF23' }],
                            gps: [1458.487697, 50.347589, 1],
                            panoData: { poseHeading: 318 },
                            sphereCorrection: { pan: '-30deg' },
                        },

                        {
                            id:'GF23',
                             panorama:'/DEPSTAR/img/23.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF25'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF24',
                             panorama:'/DEPSTAR/img/24.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF25'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id: 'GF25',
                            panorama: '/DEPSTAR/img/25.jpg',
                            name: 'GROUND_FLOOR',
                            links: [{ nodeId: 'GF26' }],
                            gps: [1458.487697, 50.347589, 1],
                            panoData: { poseHeading: 318 },
                            sphereCorrection: { pan: '-30deg' },
                        },
                        {
                            id: 'GF26',
                            panorama: '/DEPSTAR/img/26.jpg',
                            name: 'GROUND_FLOOR',
                            links: [{ nodeId: 'GF27' }],
                            gps: [1458.487697, 50.347589, 1],
                            panoData: { poseHeading: 318 },
                            sphereCorrection: { pan: '-30deg' },
                        },
                        {
                            id: 'GF27',
                            panorama: '/DEPSTAR/img/27.jpg',
                            name: 'GROUND_FLOOR',
                            links: [{ nodeId: 'GF28' }],
                            gps: [1458.487697, 50.347589, 1],
                            panoData: { poseHeading: 318 },
                            sphereCorrection: { pan: '-30deg' },
                        },
                        {
                            id:'GF28',
                             panorama:'/DEPSTAR/img/28.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF29'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF29',
                             panorama:'/DEPSTAR/img/29.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF30'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF30',
                             panorama:'/DEPSTAR/img/30.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF31'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF31',
                             panorama:'/DEPSTAR/img/31.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF32'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF32',
                             panorama:'/DEPSTAR/img/32.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF33'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF33',
                             panorama:'/DEPSTAR/img/33.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF34'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF34',
                             panorama:'/DEPSTAR/img/34.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF35'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF35',
                             panorama:'/DEPSTAR/img/35.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF36'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF36',
                             panorama:'/DEPSTAR/img/36.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF37'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF37',
                             panorama:'/DEPSTAR/img/37.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF38'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF38',
                             panorama:'/DEPSTAR/img/38.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF39'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF39',
                             panorama:'/DEPSTAR/img/39.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF40'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF40',
                             panorama:'/DEPSTAR/img/40.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF41'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF41',
                             panorama:'/DEPSTAR/img/41.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF42'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF42',
                             panorama:'/DEPSTAR/img/42.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF43'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF43',
                             panorama:'/DEPSTAR/img/43.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF44'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF44',
                             panorama:'/DEPSTAR/img/44.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF45'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF45',
                             panorama:'/DEPSTAR/img/45.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF46'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF46',
                             panorama:'/DEPSTAR/img/46.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF47'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF47',
                             panorama:'/DEPSTAR/img/47.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF48'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF48',
                             panorama:'/DEPSTAR/img/48.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF49'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF49',
                             panorama:'/DEPSTAR/img/49.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF50'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF50',
                             panorama:'/DEPSTAR/img/50.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF51'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF51',
                             panorama:'/DEPSTAR/img/51.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF52'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF52',
                             panorama:'/DEPSTAR/img/52.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF53'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF53',
                             panorama:'/DEPSTAR/img/53.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF54'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF54',
                             panorama:'/DEPSTAR/img/54.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF55'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'},
                        },
                        {
                            id:'GF55',
                             panorama:'/DEPSTAR/img/54.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF56'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'}, 
                        },
                        {
                            id:'GF56',
                             panorama:'/DEPSTAR/img/56.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF57'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'}, 
                        },
                        {
                            id:'GF57',
                             panorama:'/DEPSTAR/img/57.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF58'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'}, 
                        },
                        {
                            id:'GF58',
                             panorama:'/DEPSTAR/img/58.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF59'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'}, 
                        },
                        {
                            id:'GF59',
                             panorama:'/DEPSTAR/img/59.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF60'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'}, 
                        },
                        {
                            id:'GF60',
                             panorama:'/DEPSTAR/img/60.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF61'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'}, 
                        },
                        {
                            id:'GF61',
                             panorama:'/DEPSTAR/img/61.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF62'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'}, 
                        },
                        {
                            id:'GF62',
                             panorama:'/DEPSTAR/img/62.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF63'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'}, 
                        },
                        {
                            id:'GF63',
                             panorama:'/DEPSTAR/img/63.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF64'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'}, 
                        },
                        {
                            id:'GF64',
                             panorama:'/DEPSTAR/img/64.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF65'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'}, 
                        },
                        {
                            id:'GF65',
                             panorama:'/DEPSTAR/img/65.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF66'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'}, 
                        },
                        {
                            id:'GF66',
                             panorama:'/DEPSTAR/img/66.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF67'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'}, 
                        },
                        {
                            id:'GF67',
                             panorama:'/DEPSTAR/img/67.jpg',
                             name:'GROUND_FLOOR',
                             links:[{nodeId:'GF1'}],
                             gps:[1458.487697,50.347589,1],
                             panoData:{poseHeading:'318'},
                             sphereCorrection:{pan:'-30deg'}, 
                        },
                        
    ], '');
    viewer.addEventListener('click', ({ data }) => {
    const { yaw, pitch, rightclick } = data;
    const currentNode = virtualTour.getCurrentNode();
    
    console.log(`${rightclick ? 'Right-clicked' : 'Clicked'} at:`);
    console.log(`Yaw: ${yaw.toFixed(2)}°`);
    console.log(`Pitch: ${pitch.toFixed(2)}°`);
    
    if (currentNode && currentNode.gps) {
        const [currentLongitude, currentLatitude, currentAltitude] = currentNode.gps;
        console.log(`Current Node GPS Coordinates: Longitude: ${currentLongitude}, Latitude: ${currentLatitude}, Altitude: ${currentAltitude}`);
        
        // Approximate GPS changes based on yaw and pitch
        const deltaLongitude = yaw * 0.1; // Adjust 0.1 to a more suitable scale
        const deltaLatitude = pitch * 0.1; // Adjust 0.1 to a more suitable scale
        
        // Calculate new GPS coordinates based on click
        const newLongitude = currentLongitude + deltaLongitude;
        const newLatitude = currentLatitude + deltaLatitude;
        
        console.log(`Estimated Click GPS Coordinates: Longitude: ${newLongitude.toFixed(6)}, Latitude: ${newLatitude.toFixed(6)}, Altitude: ${currentAltitude}`);
    } else {
        console.log('No GPS data for this node.');
    }
});

    // viewer.addEventListener('click', ({ data }) => {
    //     console.log(`${data.rightclick ? 'right ' : ''}clicked at yaw: ${data.yaw} pitch: ${data.pitch}`);
    // });
</script>
